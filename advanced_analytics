### customer lifetime value
select c.customer_id, c.first_name, c.last_name, sum(p.amount) AS lifetime_value
from customer as c
left join payment as p
on c.customer_id = p.customer_id
group by c.customer_id, c.first_name, c.last_name
order by lifetime_value desc;

### consumer behavior
select r1.inventory_id as dvd1_id,
       r2.inventory_id as dvd2_id,
       count(*) as rental_count
from rental r1
join rental r2 ON r1.rental_id = r2.rental_id AND r1.inventory_id < r2.inventory_id
where r1.inventory_id <> r2.inventory_id
gorup by r1.inventory_id, r2.inventory_id
having count(*) >= 2
order by rental_count desc;
